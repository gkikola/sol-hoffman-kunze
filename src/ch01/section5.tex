\section{Matrix Multiplication}

\Exercise1 Let
\begin{equation*}
  A =
  \begin{bmatrix}
    2 & -1 & 1 \\
    1 & 2 & 1
  \end{bmatrix},
  \quad
  B =
  \begin{bmatrix}
    3 \\
    1 \\
    -1
  \end{bmatrix},
  \quad
  C =
  \begin{bmatrix}
    1 & -1
  \end{bmatrix}.
\end{equation*}
Compute $ABC$ and $CAB$.
\begin{solution}
  We get
  \begin{align*}
    ABC
    &=
    \begin{bmatrix}
      2 & -1 & 1 \\
      1 & 2 & 1
    \end{bmatrix}
    \left(
      \begin{bmatrix}
        3 \\
        1 \\
        -1
      \end{bmatrix}
      \begin{bmatrix}
        1 & -1
      \end{bmatrix}
    \right) \\
    &=
    \begin{bmatrix}
      2 & -1 & 1 \\
      1 & 2 & 1
    \end{bmatrix}
    \begin{bmatrix}
      3 & -3 \\
      1 & -1 \\
      -1 & 1
    \end{bmatrix}
    =
    \begin{bmatrix}
      4 & -4 \\
      4 & -4
    \end{bmatrix},
  \end{align*}
  and
  \begin{align*}
    CAB
    &=
    \begin{bmatrix}
      1 & -1
    \end{bmatrix}
    \left(
      \begin{bmatrix}
        2 & -1 & 1 \\
        1 & 2 & 1
      \end{bmatrix}
      \begin{bmatrix}
        3 \\
        1 \\
        -1
      \end{bmatrix}
    \right) \\
    &=
    \begin{bmatrix}
      1 & -1
    \end{bmatrix}
    \begin{bmatrix}
      4 \\
      4
    \end{bmatrix}
    =
    \begin{bmatrix}
      0
    \end{bmatrix}. \qedhere
  \end{align*}
\end{solution}

\Exercise2
\label{eq:lin-eq:mat-mul:A-sq-B}
Let
\begin{equation*}
  A =
  \begin{bmatrix}
    1 & -1 & 1 \\
    2 & 0 & 1 \\
    3 & 0 & 1
  \end{bmatrix},
  \quad
  B =
  \begin{bmatrix}
    2 & -2 \\
    1 & 3 \\
    4 & 4
  \end{bmatrix}.
\end{equation*}
Verify directly that $A(AB) = A^2B$.
\begin{solution}
  We have
  \begin{align*}
    A(AB)
    &=
    \begin{bmatrix}
      1 & -1 & 1 \\
      2 & 0 & 1 \\
      3 & 0 & 1
    \end{bmatrix}
    \left(
      \begin{bmatrix}
        1 & -1 & 1 \\
        2 & 0 & 1 \\
        3 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        2 & -2 \\
        1 & 3 \\
        4 & 4
      \end{bmatrix}
    \right) \\
    &=
    \begin{bmatrix}
      1 & -1 & 1 \\
      2 & 0 & 1 \\
      3 & 0 & 1
    \end{bmatrix}
    \begin{bmatrix}
      5 & -1 \\
      8 & 0 \\
      10 & -2
    \end{bmatrix}
    =
    \begin{bmatrix}
      7 & -3 \\
      20 & -4 \\
      25 & -5
    \end{bmatrix},
  \end{align*}
  and
  \begin{align*}
    A^2B
    &=
    \begin{bmatrix}
      1 & -1 & 1 \\
      2 & 0 & 1 \\
      3 & 0 & 1
    \end{bmatrix}^2
    \begin{bmatrix}
      2 & -2 \\
      1 & 3 \\
      4 & 4
    \end{bmatrix} \\
    &=
    \begin{bmatrix}
      2 & -1 & 1 \\
      5 & -2 & 3 \\
      6 & -3 & 4
    \end{bmatrix}
    \begin{bmatrix}
      2 & -2 \\
      1 & 3 \\
      4 & 4
    \end{bmatrix} \\
    &=
    \begin{bmatrix}
      7 & -3 \\
      20 & -4 \\
      25 & -5
    \end{bmatrix}.
  \end{align*}
  So $A(AB) = A^2B$ as expected.
\end{solution}

\Exercise3 Find two different $2\times2$ matrices $A$ such that
$A^2 = 0$ but $A\neq0$.
\begin{solution}
  Two possibilities are
  \begin{equation*}
    \begin{bmatrix}
      0 & 1 \\
      0 & 0
    \end{bmatrix}
    \quad\text{and}\quad
    \begin{bmatrix}
      0 & 0 \\
      1 & 0
    \end{bmatrix}.
  \end{equation*}
  Both of these are nonzero matrices that satisfy $A^2 = 0$.
\end{solution}

\Exercise4 For the matrix $A$ of
Exercise~\ref{eq:lin-eq:mat-mul:A-sq-B}, find elementary matrices
$E_1, E_2, \dots, E_k$ such that
\begin{equation*}
  E_k\cdots E_2E_1A = I.
\end{equation*}
\begin{solution}
  We want to reduce
  \begin{equation*}
    A =
    \begin{bmatrix}
      1 & -1 & 1 \\
      2 & 0 & 1 \\
      3 & 0 & 1
    \end{bmatrix}
  \end{equation*}
  to the identity matrix. To start, we can use two elementary row
  operations of the second kind to get $0$ as the bottom two entries
  of column $1$. Performing the same operations on the identity matrix
  gives
  \begin{equation*}
    E_1 =
    \begin{bmatrix}
      1 & 0 & 0 \\
      -2 & 1 & 0 \\
      0 & 0 & 1
    \end{bmatrix}
    \quad\text{and}\quad
    E_2 =
    \begin{bmatrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      -3 & 0 & 1
    \end{bmatrix}.
  \end{equation*}
  Then
  \begin{equation*}
    E_2E_1A =
    \begin{bmatrix}
      1 & -1 & 1 \\
      0 & 2 & -1 \\
      0 & 3 & -2
    \end{bmatrix}.
  \end{equation*}
  Next, we can use a row operation of the first kind to make the
  central entry into a $1$:
  \begin{equation*}
    E_3 =
    \begin{bmatrix}
      1 & 0 & 0 \\[3pt]
      0 & \frac12 & 0 \\[3pt]
      0 & 0 & 1
    \end{bmatrix},
    \quad\text{so that}\quad
    E_3E_2E_1A =
    \begin{bmatrix}
      1 & -1 & 1 \\[3pt]
      0 & 1 & -\frac12 \\[3pt]
      0 & 3 & -2
    \end{bmatrix}.
  \end{equation*}
  Continuing in this way, we get
  \begin{equation*}
    E_4 =
    \begin{bmatrix}
      1 & 1 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{bmatrix}
    \quad\text{and}\quad
    E_5 =
    \begin{bmatrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & -3 & 1
    \end{bmatrix},
  \end{equation*}
  so that
  \begin{equation*}
    E_5E_4E_3E_2E_1A =
    \begin{bmatrix}
      1 & 0 & \frac12 \\[3pt]
      0 & 1 & -\frac12 \\[3pt]
      0 & 0 & -\frac12
    \end{bmatrix}.
  \end{equation*}
  Then
  \begin{equation*}
    E_6 =
    \begin{bmatrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & -2
    \end{bmatrix}
    \quad\text{so that}\quad
    E_6E_5E_4E_3E_2E_1A =
    \begin{bmatrix}
      1 & 0 & \frac12 \\[3pt]
      0 & 1 & -\frac12 \\[3pt]
      0 & 0 & 1
    \end{bmatrix}.
  \end{equation*}
  Finally,
  \begin{equation*}
    E_7 =
    \begin{bmatrix}
      1 & 0 & 0 \\[3pt]
      0 & 1 & \frac12 \\[3pt]
      0 & 0 & 1
    \end{bmatrix}
    \quad\text{and}\quad
    E_8 =
    \begin{bmatrix}
      1 & 0 & -\frac12 \\[3pt]
      0 & 1 & 0 \\[3pt]
      0 & 0 & 1
    \end{bmatrix},
  \end{equation*}
  which gives
  \begin{equation*}
    E_8E_7E_6E_5E_4E_3E_2E_1 =
    \begin{bmatrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{bmatrix}
    = I.
  \end{equation*}
  Thus each of $E_1,E_2,\dots,E_8$ are elementary matrices, and they
  are such that $E_8\cdots E_2E_1A = I$.
\end{solution}

\Exercise5 Let
\begin{equation*}
  A =
  \begin{bmatrix}
    1 & -1 \\
    2 & 2 \\
    1 & 0
  \end{bmatrix}
  \quad\text{and}\quad
  B =
  \begin{bmatrix}
    3 & 1 \\
    -4 & 4
  \end{bmatrix}.
\end{equation*}
Is there a matrix $C$ such that $CA = B$?
\begin{solution}
  Suppose there is, and let
  \begin{equation*}
    C =
    \begin{bmatrix}
      c_1 & c_2 & c_3 \\
      c_4 & c_5 & c_6
    \end{bmatrix}.
  \end{equation*}
  Then
  \begin{equation*}
    \begin{bmatrix}
      c_1 & c_2 & c_3 \\
      c_4 & c_5 & c_6
    \end{bmatrix}
    \begin{bmatrix}
      1 & -1 \\
      2 & 2 \\
      1 & 0
    \end{bmatrix}
    =
    \begin{bmatrix}
      3 & 1 \\
      -4 & 4
    \end{bmatrix}.
  \end{equation*}
  This leads to the following system of equations:
  \begin{equation*}
    \begin{split}
      \phantom{-{}}c_1 + 2c_2 + c_3 &= 3, \\
      -c_1 + 2c_2 \phantom{{}+c_3} &= 1,
    \end{split}
    \qquad\qquad
    \begin{split}
      \phantom{-{}}c_4 + 2c_5 + c_6 &= -4, \\
      -c_4 + 2c_5 \phantom{{}+c_6} &= 4.
    \end{split}
  \end{equation*}
  This system has solutions
  \begin{equation*}
    (c_1,c_2,c_3,c_4,c_5,c_6) =
    (1 - 2s, 1 - s, 4s, 2t - 4, t, -4t).
  \end{equation*}
  For example, taking $s = t = -1$, we get the matrix
  \begin{equation*}
    C =
    \begin{bmatrix}
      3 & 2 & -4 \\
      -6 & -1 & 4
    \end{bmatrix},
  \end{equation*}
  and one can easily verify that $CA = B$.
\end{solution}
