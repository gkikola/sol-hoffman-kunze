\section{Linear Functionals}

\Exercise1 In $R^3$, let $\alpha_1 = (1, 0, 1)$,
$\alpha_2 = (0, 1, -2)$, $\alpha_3 = (-1, -1, 0)$.
\begin{enumerate}
\item If $f$ is a linear functional on $R^3$ such that
  \begin{equation*}
    f(\alpha_1) = 1, \quad
    f(\alpha_2) = -1, \quad
    f(\alpha_3) = 3,
  \end{equation*}
  and if $\alpha = (a, b, c)$, find $f(\alpha)$.
  \begin{solution}
    Suppose $f(x_1,x_2,x_3) = c_1x_1 + c_2x_2 + c_3x_3$. Then
    \begin{alignat*}{5}
      f(\alpha_1)
      &{}={}& c_1 && &{}+{}& c_3 &{}={}& 1 &, \\
      f(\alpha_2)
      &{}={}& && c_2 &{}-{}& 2c_3 &{}={}& -1 &, \\
      f(\alpha_3)
      &{}={}& -c_1 &{}-{}& c_2 && &{}={}& 3 &.
    \end{alignat*}
    Row-reducing the augmented matrix for this system gives
    \begin{equation*}
      \begin{bmatrix}
        1 & 0 & 1 & 1 \\
        0 & 1 & -2 & -1 \\
        -1 & -1 & 0 & 3
      \end{bmatrix}
      \rightarrow
      \begin{bmatrix}
        1 & 0 & 0 & 4 \\
        0 & 1 & 0 & -7 \\
        0 & 0 & 1 & -3
      \end{bmatrix},
    \end{equation*}
    so $c_1 = 4$, $c_2 = -7$, and $c_3 = -3$. Therefore
    \begin{equation*}
      f(\alpha) = 4a - 7b - 3c. \qedhere
    \end{equation*}
  \end{solution}

\item Describe explicitly a linear functional $f$ on $R^3$ such that
  \begin{equation*}
    f(\alpha_1) = f(\alpha_2) = 0 \quad\text{but}\quad
    f(\alpha_3) \neq 0.
  \end{equation*}
  \begin{solution}
    For example, suppose $f(\alpha_1) = f(\alpha_2) = 0$ but
    $f(\alpha_3) = 1$. As above, this leads to a system of linear
    equations having augmented matrix
    \begin{equation*}
      \begin{bmatrix}
        1 & 0 & 1 & 0 \\
        0 & 1 & -2 & 0 \\
        -1 & -1 & 0 & 1
      \end{bmatrix}
      \rightarrow
      \begin{bmatrix}
        1 & 0 & 0 & 1 \\
        0 & 1 & 0 & -2 \\
        0 & 0 & 1 & -1
      \end{bmatrix}.
    \end{equation*}
    So we may write
    \begin{equation*}
      f(x_1,x_2,x_3) = x_1 - 2x_2 - x_3. \qedhere
    \end{equation*}
  \end{solution}

\item Let $f$ be any linear functional such that
  \begin{equation*}
    f(\alpha_1) = f(\alpha_2) = 0 \quad\text{and}\quad
    f(\alpha_3) \neq 0.
  \end{equation*}
  If $\alpha = (2, 3, -1)$, show that $f(\alpha)\neq0$.
  \begin{solution}
    By inspection, we see that
    \begin{equation*}
      \alpha = -\alpha_1 - 3\alpha_3.
    \end{equation*}
    Therefore
    \begin{align*}
      f(\alpha)
      &= f(-\alpha_1 - 3\alpha_3) \\
      &= -f(\alpha_1) - 3f(\alpha_3) \\
      &= -3f(\alpha_3) \neq 0. \qedhere
    \end{align*}
  \end{solution}
\end{enumerate}

\Exercise2 Let $\mathcal{B} = \{\alpha_1,\alpha_2,\alpha_3\}$ be the
basis for $C^3$ defined by
\begin{equation*}
  \alpha_1 = (1,0,-1), \quad
  \alpha_2 = (1,1,1), \quad
  \alpha_3 = (2,2,0).
\end{equation*}
Find the dual basis of $\mathcal{B}$.
\begin{solution}
  Let $\{f_1,f_2,f_3\}$ be the dual basis of $\mathcal{B}$, and let
  \begin{equation*}
    P =
    \begin{bmatrix}
      1 & 1 & 2 \\
      0 & 1 & 2 \\
      -1 & 1 & 0
    \end{bmatrix},
  \end{equation*}
  so that $P$ is the transition matrix from $\mathcal{B}$ to the
  standard ordered basis of $C^3$. We find
  \begin{equation*}
    P^{-1} =
    \begin{bmatrix}
      1 & -1 & 0 \\[3pt]
      1 & -1 & 1 \\[3pt]
      -\frac12 & 1 & -\frac12
    \end{bmatrix}.
  \end{equation*}
  So, given a vector $\alpha = (x_1,x_2,x_3)$ in $C_3$, we can write
  \begin{equation*}
    [\alpha]_{\mathcal{B}} = P^{-1}
    \begin{bmatrix}
      x_1 \\ x_2 \\ x_3
    \end{bmatrix}.
  \end{equation*}
  Therefore
  \begin{equation*}
    f_1(x_1,x_2,x_3) =
    \begin{bmatrix}
      1 & 0 & 0
    \end{bmatrix}
    \begin{bmatrix}
      1 & -1 & 0 \\[3pt]
      1 & -1 & 1 \\[3pt]
      -\frac12 & 1 & -\frac12
    \end{bmatrix}
    \begin{bmatrix}
      x_1 \\ x_2 \\ x_3
    \end{bmatrix}
    = x_1 - x_2.
  \end{equation*}
  Similarly, we get
  \begin{equation*}
    f_2(x_1,x_2,x_3) =
    \begin{bmatrix}
      0 & 1 & 0
    \end{bmatrix}
    \begin{bmatrix}
      1 & -1 & 0 \\[3pt]
      1 & -1 & 1 \\[3pt]
      -\frac12 & 1 & -\frac12
    \end{bmatrix}
    \begin{bmatrix}
      x_1 \\ x_2 \\ x_3
    \end{bmatrix}
    = x_1 - x_2 + x_3,
  \end{equation*}
  and
  \begin{equation*}
    f_3(x_1,x_2,x_3) =
    \begin{bmatrix}
      0 & 0 & 1
    \end{bmatrix}
    \begin{bmatrix}
      1 & -1 & 0 \\[3pt]
      1 & -1 & 1 \\[3pt]
      -\frac12 & 1 & -\frac12
    \end{bmatrix}
    \begin{bmatrix}
      x_1 \\ x_2 \\ x_3
    \end{bmatrix}
    = -\frac12x_1 + x_2 - \frac12x_3.
    \qedhere
  \end{equation*}
\end{solution}

\Exercise3
\label{exercise:lin-tran:trace-AB-eq-trace-BA}
If $A$ and $B$ are $n\times n$ matrices over the field $F$, show that
$\trace(AB) = \trace(BA)$. Now show that similar matrices have the
same trace.
\begin{proof}
  We may directly compute
  \begin{align*}
    \tr(AB)
    &= \sum_{i=1}^n(AB)_{ii} \\
    &= \sum_{i=1}^n\sum_{j=1}^nA_{ij}B_{ji}
    = \sum_{j=1}^n\sum_{i=1}^nB_{ji}A_{ij} \\
    &= \sum_{j=1}^n(BA)_{jj} \\
    &= \tr(BA).
  \end{align*}
  So $\tr(AB) = \tr(BA)$.

  Next, suppose $A$ and $B$ are similar, and let $P$ be an invertible
  $n\times n$ matrix such that $B = P^{-1}AP$. Using the fact that was
  proven above, we get
  \begin{align*}
    \tr(B)
    &= \tr(P^{-1}AP) \\
    &= \tr((P^{-1}A)P) \\
    &= \tr(P(P^{-1}A)) \\
    &= \tr((PP^{-1})A) \\
    &= \tr(A).
  \end{align*}
  This shows that similar matrices have the same trace.
\end{proof}

\Exercise4 Let $V$ be the vector space of all polynomial functions $p$
from $R$ into $R$ which have degree $2$ or less:
\begin{equation*}
  p(x) = c_0 + c_1x + c_2x^2.
\end{equation*}
Define three linear functionals on $V$ by
\begin{equation*}
  f_1(p) = \int_0^1p(x)\,dx, \quad
  f_2(p) = \int_0^2p(x)\,dx, \quad
  f_3(p) = \int_0^{-1}p(x)\,dx.
\end{equation*}
Show that $\{f_1,f_2,f_3\}$ is a basis for $V^*$ by exhibiting the
basis for $V$ of which it is the dual.
\begin{solution}
  First we evaluate,
  \begin{align*}
    f_1(p) &= \left(c_0x + \frac12c_1x^2 + \frac13c_2x^3\right)\Bigg|_0^1
    = c_0 + \frac12c_1 + \frac13c_2, \\
    f_2(p) &= \left(c_0x + \frac12c_1x^2 + \frac13c_2x^3\right)\Bigg|_0^2
    = 2c_0 + 2c_1 + \frac83c_2, \\
    f_3(p) &= \left(c_0x + \frac12c_1x^2 + \frac13c_2x^3\right)\Bigg|_0^{-1}
    = -c_0 + \frac12c_1 - \frac13c_2.
  \end{align*}
  Now, let $\{p_1,p_2,p_3\}$ be the basis for $V$ of which
  $\{f_1,f_2,f_3\}$ is the dual. To determine $p_i$, we want to find
  values for the coefficients $c_1$, $c_2$, and $c_3$ so that
  $f_i(p_i) = 1$ and $f_j(p_i) = 0$ for $j\neq i$. This gives three
  systems of linear equations, having augmented matrices
  \begin{equation*}
    \begin{bmatrix}
      1 & \frac12 & \frac13 & 1 \\[3pt]
      2 & 2 & \frac83 & 0 \\[3pt]
      -1 & \frac12 & -\frac13 & 0
    \end{bmatrix}, \quad
    \begin{bmatrix}
      1 & \frac12 & \frac13 & 0 \\[3pt]
      2 & 2 & \frac83 & 1 \\[3pt]
      -1 & \frac12 & -\frac13 & 0
    \end{bmatrix}, \quad\text{and}\quad
    \begin{bmatrix}
      1 & \frac12 & \frac13 & 0 \\[3pt]
      2 & 2 & \frac83 & 0 \\[3pt]
      -1 & \frac12 & -\frac13 & 1
    \end{bmatrix}.
  \end{equation*}
  We can combine these into a single augmented matrix and perform
  row-reduction, which gives
  \begin{equation*}
    \begin{bmatrix}
      1 & \frac12 & \frac13 & 1 & 0 & 0 \\[3pt]
      2 & 2 & \frac83 & 0 & 1 & 0 \\[3pt]
      -1 & \frac12 & -\frac13 & 0 & 0 & 1
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      1 & 0 & 0 & 1 & -\frac16 & -\frac13 \\[3pt]
      0 & 1 & 0 & 1 & 0 & 1 \\[3pt]
      0 & 0 & 1 & -\frac32 & \frac12 & -\frac12
    \end{bmatrix}.
  \end{equation*}
  So we see that
  \begin{align*}
    p_1(x) &= 1 + x - \frac32x^2, \\
    p_2(x) &= -\frac16 + \frac12x^2, \\
    p_3(x) &= -\frac13 + x - \frac12x^2,
  \end{align*}
  and $\{f_1,f_2,f_3\}$ is the dual basis of $\{p_1,p_2,p_3\}$.
\end{solution}

\Exercise5 If $A$ and $B$ are $n\times n$ complex matrices, show that
$AB - BA = I$ is impossible.
\begin{proof}
  In Example~19, the trace function was shown to be a linear
  functional on the space of $n\times n$ matrices. And in
  Exercise~\ref{exercise:lin-tran:trace-AB-eq-trace-BA}, we proved
  that, given two matrices $A$ and $B$, $\tr(AB) = \tr(BA)$. It now
  follows that
  \begin{equation*}
    \tr(AB - BA) = \tr(AB) - \tr(BA) = 0.
  \end{equation*}
  But $\tr(I) = n\neq0$, so it cannot be the case that $AB - BA = I$.
\end{proof}

\Exercise6 Let $m$ and $n$ be positive integers and $F$ a field. Let
$f_1,\dots,f_m$ be linear functionals on $F^n$. For $\alpha$ in $F^n$
define
\begin{equation*}
  T\alpha = (f_1(\alpha), \dots, f_m(\alpha)).
\end{equation*}
Show that $T$ is a linear transformation from $F^n$ into $F^m$. Then
show that every linear transformation from $F^n$ into $F^m$ is of the
above form, for some $f_1,\dots,f_m$.
\begin{proof}
  First, for any $\alpha_1,\alpha_2$ in $F^n$ and any $c$ in $F$, we
  have
  \begin{align*}
    T(c\alpha_1 + \alpha_2)
    &= (f_1(c\alpha_1 + \alpha_2), \dots, f_m(c\alpha_1 + \alpha_2)) \\
    &= (cf_1(\alpha_1) + f_1(\alpha_2),
      \dots, cf_m(\alpha_1) + f_m(\alpha_2)) \\
    &= c(f_1(\alpha_1), \dots, f_m(\alpha_1))
      + (f_1(\alpha_2), \dots, f_m(\alpha_2)) \\
    &= cT\alpha_1 + T\alpha_2.
  \end{align*}
  This shows that $T$ is a linear transformation from $F^n$ into
  $F^m$.

  Next, let $T$ be any linear transformation from $F^n$ into
  $F^m$. For each $i$ with $1\leq i\leq m$, define $f_i(\alpha)$ to be
  the $i$th coordinate of $T\alpha$. Then
  \begin{equation*}
    T\alpha = (f_1(\alpha), \dots, f_m(\alpha))
  \end{equation*}
  and, moreover, each $f_i$ is a linear transformation because $T$
  itself is linear. Therefore every linear transformation from $F^n$
  into $F^m$ can be written this way.
\end{proof}

\Exercise7 Let $\alpha_1 = (1, 0, -1, 2)$ and
$\alpha_2 = (2, 3, 1, 1)$, and let $W$ be the subspace of $R^4$
spanned by $\alpha_1$ and $\alpha_2$. Which linear functionals $f$:
\begin{equation*}
  f(x_1,x_2,x_3,x_4) = c_1x_1 + c_2x_2 + c_3x_3 + c_4x_4
\end{equation*}
are in the annihilator of $W$?
\begin{solution}
  Let $f$ be in $W^0$. We want
  \begin{equation*}
    f(1, 0, -1, 2) = f(2, 3, 1, 1) = 0.
  \end{equation*}
  This leads to a system of equations in $c_1,c_2,c_3,c_4$ having
  coefficient matrix
  \begin{equation*}
    \begin{bmatrix}
      1 & 0 & -1 & 2 \\
      2 & 3 & 1 & 1
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      1 & 0 & -1 & 2 \\
      0 & 1 & 1 & -1
    \end{bmatrix}.
  \end{equation*}
  From the reduced form we see that $c_3$ and $c_4$ can be arbitrary,
  with
  \begin{equation*}
    c_1 = c_3 - 2c_4 \quad\text{and}\quad c_2 = c_4 - c_3.
  \end{equation*}
  Therefore $W^0$ consists of the linear functionals $f$ having the
  form
  \begin{equation*}
    f(x_1,x_2,x_3,x_4) = (s - 2t)x_1 + (t - s)x_2 + sx_3 + tx_4,
  \end{equation*}
  where $s$ and $t$ are scalars in $F$. Note that we can also find a
  basis for $W^0$ by first taking $s = 1, t = 0$ and then by taking
  $s = 0, t = 1$.
\end{solution}

\Exercise8 Let $W$ be the subspace of $R^5$ which is spanned by the
vectors
\begin{align*}
  \alpha_1
  &= \epsilon_1 + 2\epsilon_2 + \epsilon_3, \quad
    \alpha_2 = \epsilon_2 + 3\epsilon_3 + 3\epsilon_4 + \epsilon_5 \\
  \alpha_3
  &= \epsilon_1 + 4\epsilon_2 + 6\epsilon_3 + 4\epsilon_4 + \epsilon_5.
\end{align*}
Find a basis for $W^0$.
\begin{solution}
  Take $f$ in $W^0$, and write
  \begin{equation*}
    f(x_1,x_2,x_3,x_4,x_5)
    = c_1x_1 + c_2x_2 + c_3x_3 + c_4x_4 + c_5x_5.
  \end{equation*}
  Since $f$ annihilates $W$, we have
  \begin{alignat*}{7}
    f(\alpha_1) &{}={}&
    c_1 &{}+{}& 2c_2 &{}+{}& c_3 && && &{}={}& 0 & \\
    f(\alpha_2) &{}={}&
    && c_2 &{}+{}& 3c_3 &{}+{}& 3c_4 &{}+{}& c_5 &{}={}& 0 & \\
    f(\alpha_3) &{}={}&
    c_1 &{}+{}& 4c_2 &{}+{}& 6c_3 &{}+{}& 4c_4 &{}+{}& c_5
    &{}={}& 0 &.
  \end{alignat*}
  The coefficient matrix for this system reduces as follows:
  \begin{equation*}
    \begin{bmatrix}
      1 & 2 & 1 & 0 & 0 \\
      0 & 1 & 3 & 3 & 1 \\
      1 & 4 & 6 & 4 & 1
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      1 & 0 & 0 & 4 & 3 \\
      0 & 1 & 0 & -3 & -2 \\
      0 & 0 & 1 & 2 & 1
    \end{bmatrix}.
  \end{equation*}
  Since the latter matrix has three nonzero rows, we see that $W$ has
  dimension $3$ and $\{\alpha_1,\alpha_2,\alpha_3\}$ is a basis for
  $W$. We also see that
  \begin{align*}
    c_1 &= -4c_4 - 3c_5, \\
    c_2 &= 3c_4 + 2c_5, \\
    \intertext{and}
    c_3 &= -2c_4 - c_5.
  \end{align*}
  Therefore the set $\{f_1,f_2\}$, where
  \begin{equation*}
    f_1(x_1,x_2,x_3,x_4,x_5)
    = -4x_1 + 3x_2 - 2x_3 + x_4
  \end{equation*}
  and
  \begin{equation*}
    f_2(x_1,x_2,x_3,x_4,x_5)
    = -3x_1 + 2x_2 - x_3 + x_5,
  \end{equation*}
  is a basis for $W^0$. Note that $\dim W^0 = 2$, which agrees with
  Theorem~16.
\end{solution}
