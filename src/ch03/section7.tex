\section{The Transpose of a Linear Transformation}

\Exercise1 Let $F$ be a field and let $f$ be the linear functional on
$F^2$ defined by
\begin{equation*}
  f(x_1,x_2) = ax_1 + bx_2.
\end{equation*}
For each of the following linear operators $T$, let $g = T^tf$, and
find $g(x_1,x_2)$.
\begin{enumerate}
\item $T(x_1,x_2) = (x_1,0)$
  \begin{solution}
    We have
    \begin{align*}
      g(x_1,x_2)
      &= (T^tf)(x_1,x_2) \\
      &= f(T(x_1,x_2)) \\
      &= f(x_1,0) \\
      &= ax_1. \qedhere
    \end{align*}
  \end{solution}

\item $T(x_1,x_2) = (-x_2,x_1)$
  \begin{solution}
    In this case, we get
    \begin{align*}
      g(x_1,x_2)
      &= f(T(x_1,x_2)) \\
      &= f(-x_2,x_1) \\
      &= -ax_2 + bx_1. \qedhere
    \end{align*}
  \end{solution}

\item $T(x_1,x_2) = (x_1 - x_2, x_1 + x_2)$
  \begin{solution}
    \begin{align*}
      g(x_1,x_2)
      &= f(x_1 - x_2, x_1 + x_2) \\
      &= (b + a)x_1 + (b - a)x_2. \qedhere
    \end{align*}
  \end{solution}
\end{enumerate}

\Exercise2 Let $V$ be the vector space of all polynomial functions
over the field of real numbers. Let $a$ and $b$ be fixed real numbers
and let $f$ be the linear functional on $V$ defined by
\begin{equation*}
  f(p) = \int_a^bp(x)\,dx.
\end{equation*}
If $D$ is the differentiation operator on $V$, what is $D^tf$?
\begin{solution}
  From the definition, we have
  \begin{equation*}
    (D^tf)(p)
    = f(Dp) \\
    = \int_a^b(Dp)(x)\,dx.
  \end{equation*}
  So, the fundamental theorem of calculus gives
  \begin{equation*}
    (D^tf)(p) = p(b) - p(a). \qedhere
  \end{equation*}
\end{solution}

\Exercise3 Let $V$ be the space of all $n\times n$ matrices over a
field $F$ and let $B$ be a fixed $n\times n$ matrix. If $T$ is the
linear operator on $V$ defined by $T(A) = AB - BA$, and if $f$ is the
trace function, what is $T^tf$?
\begin{solution}
  From Exercise~\ref{exercise:lin-tran:trace-AB-eq-trace-BA}, we know
  that $f(AB) = f(BA)$. So,
  \begin{align*}
    (T^tf)(A)
    &= f(TA) \\
    &= f(AB - BA) \\
    &= f(AB) - f(BA) \\
    &= 0,
  \end{align*}
  and we see that $T^tf = 0$.
\end{solution}

\Exercise4 Let $V$ be a finite-dimensional vector space over the field
$F$ and let $T$ be a linear operator on $V$. Let $c$ be a scalar and
suppose there is a non-zero vector $\alpha$ in $V$ such that
$T\alpha = c\alpha$. Prove that there is a non-zero linear functional
$f$ on $V$ such that $T^tf = cf$.
\begin{proof}
  Let $n = \dim V$ and let $\alpha$ be a nonzero vector in $V$ with
  $T\alpha = c\alpha$. Define the linear operator $U$ on $V$ by
  \begin{equation*}
    U = T - cI.
  \end{equation*}
  Then $U\alpha = T\alpha - c\alpha = 0$. Therefore $\alpha$ belongs
  to the null space of $U$, which implies (by Theorem~2) that
  $\rank(U) < n$. Now consider the linear operator $U^t$ on $V^*$. By
  Theorem~22, we have
  \begin{equation*}
    \rank(U^t) = \rank(U) < n,
  \end{equation*}
  so the nullspace of $U^t$ has dimension greater than zero. Therefore
  we can find a nonzero linear functional $f$ in $V^*$ such that
  $U^tf = 0$. Then for any $\beta$ in $V$,
  \begin{align*}
    0
    &= (U^tf)(\beta) \\
    &= f(U\beta) \\
    &= f(T\beta - c\beta) \\
    &= f(T\beta) - cf(\beta) \\
    &= (T^tf)(\beta) - cf(\beta).
  \end{align*}
  So, we have $T^tf = cf$ as required.
\end{proof}

\Exercise5 Let $A$ be an $m\times n$ matrix with {\em real}
entries. Prove that $A = 0$ if and only if $\trace(A^tA) = 0$.
\begin{proof}
  Certainly if $A = 0$, then $A^tA = 0$ and $\trace(A^tA) = 0$. We now
  need only prove the converse. Let $B = A^t$ and suppose
  $\trace(BA) = 0$. Then
  \begin{equation*}
    0
    = \sum_{j=1}^n(BA)_{jj}
    = \sum_{j=1}^n\sum_{i=1}^mB_{ji}A_{ij}
    = \sum_{j=1}^n\sum_{i=1}^mA_{ij}^2.
  \end{equation*}
  Since we have a sum of squares (of real numbers) equal to zero, it
  must be the case that each squared number is zero. In particular
  $A_{ij} = 0$ for each $i,j$, since every such entry appears in the
  sum.
\end{proof}

\Exercise6 Let $n$ be a positive integer and let $V$ be the space of
all polynomial functions over the field of real numbers which have
degree at most $n$, i.e., functions of the form
\begin{equation*}
  f(x) = c_0 + c_1x + \cdots + c_nx^n.
\end{equation*}
Let $D$ be the differentiation operator on $V$. Find a basis for the
null space of the transpose operator $D^t$.
\begin{solution}
  Let $W$ denote the range of $D$. By Theorem~22, the null space of
  $D^t$ is the annihilator of $W$. We know that $W$ is the space of
  polynomials having degree at most $n - 1$, so $\dim W = n - 1$. By
  Theorem~16, the annihilator $W^0$ must have dimension
  $n - (n - 1) = 1$, so we may take any nonzero linear functional in
  $W^0$ as a basis vector. Let $g$ be the unique linear functional
  such that
  \begin{equation*}
    g(x^k) = \delta_{nk}, \quad 1\leq k\leq n.
  \end{equation*}
  That is, $g$ sends every polynomial to the coefficient for its $x^n$
  term. In particular, $g$ annihilates $W$, so $\{g\}$ is a basis for
  $W^0$ and therefore also a basis for the null space of $D^t$.
\end{solution}

\Exercise7 Let $V$ be a finite-dimensional vector space over the field
$F$. Show that $T\to T^t$ is an isomorphism of $L(V,V)$ onto
$L(V^*,V^*)$.
\begin{proof}
  Suppose $V$ has dimension $n$ and let $U$ be the function from
  $L(V,V)$ into $L(V^*,V^*)$ given by $U(T) = T^t$. We could show that
  $U$ is an isomorphism by appealing to the definition of the
  transpose. Instead, we will write $U$ as a composition of three
  linear transformations $U_1$, $U_2$, and $U_3$, mapping
  \begin{equation*}
    L(V, V) \xrightarrow{U_1} F^{n\times n} \xrightarrow{U_2} F^{n\times n}
    \xrightarrow{U_3} L(V^*, V^*),
  \end{equation*}
  as follows. $U_1$ sends an operator $T$ to its matrix
  $[T]_{\mathcal{B}}$ in some fixed basis $\mathcal{B}$, $U_2$ sends
  an $n\times n$ matrix $A$ to its transpose $A^t$, and $U_3$ sends an
  $n\times n$ matrix $[T']_{\mathcal{B}^*}$ to its corresponding
  linear operator $T'$ on $V^*$. Then $U = U_3U_2U_1$ and it follows
  that $U$ is a linear transformation. Moreover, Theorem~12 shows that
  $U_1$ and $U_3$ are isomorphisms, and $U_2$ is an isomorphism since
  it is obviously invertible (it is its own inverse). Therefore $U$ is
  an isomorphism from $L(V,V)$ onto $L(V^*,V^*)$.
\end{proof}

\Exercise8 Let $V$ be the vector space of $n\times n$ matrices over
the field $F$.
\begin{enumerate}
\item If $B$ is a fixed $n\times n$ matrix, define a function $f_B$ on
  $V$ by $f_B(A) = \trace(B^tA)$. Show that $f_B$ is a linear
  functional on $V$.
  \begin{proof}
    Since the trace function is linear, we have
    \begin{align*}
      f_B(A_1 + cA_2)
      &= \trace(B^t(A_1 + cA_2)) \\
      &= \trace(B^tA_1 + cB^tA_2) \\
      &= \trace(B^tA_1) + c\trace(B^tA_2) \\
      &= f_B(A_1) + cf_B(A_2).
    \end{align*}
    Therefore $f_B$ is linear.
  \end{proof}

\item Show that every linear functional on $V$ is of the above form,
  i.e., is $f_B$ for some $B$.
  \begin{proof}
    Let $g$ be a linear functional on $V$. Then $g$ can be written in
    the form
    \begin{equation*}
      g(A) = \sum_{i=1}^n\sum_{j=1}^nc_{ij}A_{ij},
    \end{equation*}
    where each $c_{ij}$ is a fixed scalar in $F$. Now let $B$ be the
    matrix whose $i,j$ entry is $c_{ij}$. Then for each matrix $A$ in
    $V$,
    \begin{multline*}
      f_B(A)
      = \trace(B^tA)
      = \sum_{j=1}^n(B^tA)_{jj} \\
      = \sum_{j=1}^n\sum_{i=1}^n(B^t)_{ji}A_{ij}
      = \sum_{j=1}^n\sum_{i=1}^nc_{ij}A_{ij}
      = g(A).
    \end{multline*}
    Therefore $g = f_B$.
  \end{proof}

\item Show that $B\to f_B$ is an isomorphism of $V$ onto $V^*$.
  \begin{proof}
    Let $T$ denote the function $B\to f_B$. Then
    \begin{align*}
      T(A_1 + cA_2)(A)
      &= \trace((A_1 + cA_2)^tA) \\
      &= \trace(A_1^tA + cA_2^tA) \\
      &= \trace(A_1^tA) + c\trace(A_2^tA) \\
      &= f_{A_1}(A) + cf_{A_2}(A) \\
      &= T(A_1)(A) + cT(A_2)(A),
    \end{align*}
    so $T$ is a linear transformation. Since we have already proven
    that every linear functional on $V$ can be written as $f_B$ for
    some matrix $B$, it follows that $T$ is onto. And since
    $\dim V = \dim V^* = n^2$, this is enough to show that $T$ is an
    isomorphism (by Theorem~9).
  \end{proof}
\end{enumerate}
